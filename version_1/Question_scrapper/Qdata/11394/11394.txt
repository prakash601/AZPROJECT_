This problem is given in two editions, which differ exclusively in the constraints on the number
n
.
You are given an array of integers
a[1],a[2],…,a[n].
A block is a sequence of contiguous (consecutive) elements
a[l],a[l+1],…,a[r]
(
1≤l≤r≤n
). Thus, a block is defined by a pair of indices
(l,r)
.
Find a set of blocks
(l1,r1),(l2,r2),…,(lk,rk)
such that:
They do not intersect (i.e. they are disjoint). Formally, for each pair of blocks
(li,ri)
and
(lj,rj
) where
i≠j
either
ri<lj
or
rj<li
.
For each block the sum of its elements is the same. Formally,
a[l1]+a[l1+1]+⋯+a[r1]=a[l2]+a[l2+1]+⋯+a[r2]=
⋯=
a[lk]+a[lk+1]+⋯+a[rk].
The number of the blocks in the set is maximum. Formally, there does not exist a set of blocks
(l
′
1
,r
′
1
),(l
′
2
,r
′
2
),…,(l
′
k′
,r
′
k′
)
satisfying the above two requirements with
k′>k
.
The picture corresponds to the first example. Blue boxes illustrate blocks.
Write a program to find such a set of blocks.
Input
The first line contains integer
n
(
1≤n≤1500
) — the length of the given array. The second line contains the sequence of elements
a[1],a[2],…,a[n]
(
−105≤ai≤105
).
Output
In the first line print the integer
k
(
1≤k≤n
). The following
k
lines should contain blocks, one per line. In each line print a pair of indices
li,ri
(
1≤li≤ri≤n
) — the bounds of the
i
-th block. You can print blocks in any order. If there are multiple answers, print any of them.
Examples
input
Copy
7
4 1 2 2 1 5 3
output
Copy
3
7 7
2 3
4 5
input
Copy
11
-5 -4 -3 -2 -1 0 1 2 3 4 5
output
Copy
2
3 4
1 1
input
Copy
4
1 1 1 1
output
Copy
4
4 4
1 1
2 2
3 3